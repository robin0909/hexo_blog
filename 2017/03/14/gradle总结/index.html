<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="gradle," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="—–Java部分——1.使用java插件1apply plugin:&amp;apos;java&amp;apos;	//该插件会去src/main/java下找源代码，并打包生成build文件夹，里面有很多生成的资源

设置gradle支持utf-81[compileJava, compileTestJava]*.options*.encoding = &amp;apos;UTF-8&amp;apos;


2.定制项目123">
<meta property="og:type" content="article">
<meta property="og:title" content="gradle总结">
<meta property="og:url" content="http://yoursite.com/2017/03/14/gradle总结/index.html">
<meta property="og:site_name" content="杨冠林的博客">
<meta property="og:description" content="—–Java部分——1.使用java插件1apply plugin:&amp;apos;java&amp;apos;	//该插件会去src/main/java下找源代码，并打包生成build文件夹，里面有很多生成的资源

设置gradle支持utf-81[compileJava, compileTestJava]*.options*.encoding = &amp;apos;UTF-8&amp;apos;


2.定制项目123">
<meta property="og:updated_time" content="2017-03-14T09:28:03.490Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gradle总结">
<meta name="twitter:description" content="—–Java部分——1.使用java插件1apply plugin:&amp;apos;java&amp;apos;	//该插件会去src/main/java下找源代码，并打包生成build文件夹，里面有很多生成的资源

设置gradle支持utf-81[compileJava, compileTestJava]*.options*.encoding = &amp;apos;UTF-8&amp;apos;


2.定制项目123">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/03/14/gradle总结/"/>





  <title> gradle总结 | 杨冠林的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">杨冠林的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">谁敢说我不潇洒</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/14/gradle总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="robinyang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杨冠林的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                gradle总结
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-14T17:26:07+08:00">
                2017-03-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="—–Java部分——"><a href="#—–Java部分——" class="headerlink" title="—–Java部分——"></a>—–Java部分——</h3><h5 id="1-使用java插件"><a href="#1-使用java插件" class="headerlink" title="1.使用java插件"></a>1.使用java插件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply plugin:&apos;java&apos;	//该插件会去src/main/java下找源代码，并打包生成build文件夹，里面有很多生成的资源</div></pre></td></tr></table></figure>
<ul>
<li>设置gradle支持utf-8<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[compileJava, compileTestJava]*.options*.encoding = &apos;UTF-8&apos;</div></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="2-定制项目"><a href="#2-定制项目" class="headerlink" title="2.定制项目"></a>2.定制项目</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">version = 0.1		//项目版本</div><div class="line"></div><div class="line">//设置java版本</div><div class="line">sourceCompatibility = 1.7</div><div class="line">targetCompatibility = 1.7</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">jar&#123;				</div><div class="line">    manifest &#123;	</div><div class="line">        attributes &apos;Main-Class&apos;:&apos;com.robin.demo&apos;	//在jar包的MANIFEST.MF里添加属性（这里是运行的主类）</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">//改变默认的目录结构</div><div class="line">sourceSets &#123;</div><div class="line">    main&#123;</div><div class="line">        java&#123;</div><div class="line">            srcDirs = [&apos;src&apos;]	//默认的源码结构是src/main/java,这里修改成了src</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    test&#123;</div><div class="line">    	java&#123;</div><div class="line">            srcDirs = [&apos;test&apos;]	//默认的源码结构是src/test/java,这里修改成了test</div><div class="line">    	&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>问题：将src/main下的generated文件夹修改为类路径，如何在geadle里设置脚本？<br>马上想到的解法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sourceSets &#123;</div><div class="line">    main &#123;</div><div class="line">        java &#123;</div><div class="line">            srcDirs = [&apos;src/main/generated&apos;]</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>上面的写法是错误的，为何？因为这样设置，会将源码的目录设置成了generated，而原来的src/main/java目录就失效了，不是资源目录了。正确的写法是：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sourceSets &#123;</div><div class="line">    main &#123;</div><div class="line">        java &#123;</div><div class="line">            srcDirs += &apos;src/main/generated&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>解释</strong>：srcDirs这个属性的类型是数组，如果要改变的话就直接=[‘ ‘]，这样就改变整个数组的值，而 +=’ ‘ 是向数组里添加值。</p>
</blockquote>
<hr>
<ul>
<li>某些class不想打进jar包里去，或者war包里去，如何做？</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sourceSets &#123;</div><div class="line">    main &#123;</div><div class="line">        java &#123;</div><div class="line">            exclude &apos;com/robin/demo&apos;    //这样com.robin.demo包下的所有类都不会打进jar下</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>我们在src/main/java/**.xml的mybatis映射文件打包到war包下的classes下会失败，如何将解决？</p>
<h6 id="方式一："><a href="#方式一：" class="headerlink" title="方式一："></a>方式一：</h6><ul>
<li>在resources资源目录下新建com/robin/**.xml文件，这样打包会打到classes下的。<h6 id="方式二："><a href="#方式二：" class="headerlink" title="方式二："></a>方式二：</h6></li>
<li>将src/main/java/**.xml配置成资源目录，在build.gradle里添加：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sourceSets &#123;</div><div class="line">    main &#123;</div><div class="line">        resources &#123; </div><div class="line">            //这里的srcDir是方法，上面的是属性</div><div class="line">            srcDir &apos;src/main/java&apos; //可以将java目录下的所有非.java资源打包到classes下</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<hr>
<blockquote>
<p>输出定义：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">buildDir = &apos;out&apos;	//定义输出路径，原来的是build文件夹下的</div></pre></td></tr></table></figure></p>
</blockquote>
<h5 id="3-定义仓库"><a href="#3-定义仓库" class="headerlink" title="3.定义仓库"></a>3.定义仓库</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">repositories&#123;</div><div class="line">    jcenter()</div><div class="line">    maven &#123;</div><div class="line">        url &apos;http://maven.aliyun.com/nexus/content/groups/public&apos;--修改成阿里云的仓库</div><div class="line">    &#125;</div><div class="line">    mavenCentral()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="4-定义依赖"><a href="#4-定义依赖" class="headerlink" title="4.定义依赖"></a>4.定义依赖</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    compile group:&apos;org.apache.commons&apos;, name:&apos;comcc&apos;, version:&apos;3.1&apos;</div><div class="line">    compile &apos;org.apache.commons:comcc:3.1&apos;		--上下等价，下面是简写</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>消除依赖<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">compile (&quot;com.alibaba:dubbo:$&#123;dubboVersion&#125;&quot;) &#123;</div><div class="line">    exclude group: &quot;org.springframework&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># exclude group: groupName</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="——web——"><a href="#——web——" class="headerlink" title="——web——"></a>——web——</h3><h5 id="5-war插件的使用"><a href="#5-war插件的使用" class="headerlink" title="5.war插件的使用"></a>5.war插件的使用</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;war&apos;	--这个插件主要应用与web下开发的，并且自扩展java插件</div></pre></td></tr></table></figure>
<h6 id="结构："><a href="#结构：" class="headerlink" title="结构："></a>结构：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">|	</div><div class="line">---build.gradle</div><div class="line">|</div><div class="line">---src</div><div class="line">    |</div><div class="line">    --main</div><div class="line">        |</div><div class="line">        ---java/..</div><div class="line">        |</div><div class="line">        ---resources/..</div><div class="line">        |	</div><div class="line">        ----webapp</div><div class="line">            |</div><div class="line">            ---WEB-INF/web.xml</div><div class="line">            |</div><div class="line">            ---css/..</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">    providedCompile &apos;javax.servlet:servlet-api:2.5&apos;		--这个依赖由容器(例如tomcat)提供,这里会有jetty提供，他不会打包到war包里面</div><div class="line">			</div><div class="line">    runtime &apos;javax.servlet:jstl:1.1.2&apos;		--jstl这种依赖，编译时不需要，运行时需要，会成为war包的一部分</div><div class="line">&#125;</div><div class="line">--运行后会在build/libs下有个war包</div></pre></td></tr></table></figure>
<h5 id="6-定制web项目"><a href="#6-定制web项目" class="headerlink" title="6.定制web项目"></a>6.定制web项目</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">|</div><div class="line">--build.gradle</div><div class="line">|</div><div class="line">--src</div><div class="line">|  |</div><div class="line">|   --main/java</div><div class="line">|</div><div class="line">|</div><div class="line">---static</div><div class="line">|      |</div><div class="line">|      --css</div><div class="line">|</div><div class="line">----webfile</div><div class="line">	|</div><div class="line">	--WEB-INF/web.xml</div><div class="line">	|</div><div class="line">	---jsp/..</div></pre></td></tr></table></figure>
<blockquote>
<p>上面就是自己的定制的结构，该怎么写了？</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">webAppDirName = &apos;webfile&apos;	--默认属性是src/main/webapp</div><div class="line">	</div><div class="line">war&#123;</div><div class="line">    from &apos;static&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>添加多个war资源目录，由于from的参数是from(Object…obj)，所以用可变参数结构来添加：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">war &#123;</div><div class="line">    from &apos;static01&apos;, &apos;static02&apos;, ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="7-jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）"><a href="#7-jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）" class="headerlink" title="7.jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）"></a>7.jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;jetty&apos;</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>运行指令：gradle jettyRun (即使没有jar包也能跑起来)
</code></pre></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">jettyRun &#123;</div><div class="line">    httpPort = 80		--修改jetty运行的端口号</div><div class="line">    contextPath = &apos;todo&apos;	--修改应用名</div><div class="line">&#125;</div><div class="line">	//  http://localhost:80/todo</div></pre></td></tr></table></figure>
<h3 id="—–gradle的接口——"><a href="#—–gradle的接口——" class="headerlink" title="—–gradle的接口——"></a>—–gradle的接口——</h3><h5 id="8-我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可"><a href="#8-我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可" class="headerlink" title="8.我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可"></a>8.我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">version &apos;1.0&apos;	--调用Project里的setVersion(..)方法的</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>当然我们可以在build.gradle里定义自己的外部属性，然后直接引用自己定义属性，通过
ext命名空间：
</code></pre></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ext &#123;</div><div class="line">    vertxVersion = &quot;3.1.2&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>使用：
</code></pre></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">compile &quot;io.vertx:vertx-core:$&#123;vertxVersion&#125;&quot;	--这里一定要用&quot;&quot;来引起字符串，不要用&apos;&apos;，否则$&#123;vertxVersion&#125;就变成了字符串而不会被转义</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>**建议：**
</code></pre><p>尽量使用” “而少使用’ ‘</p>
</blockquote>
<h5 id="9-自定义task"><a href="#9-自定义task" class="headerlink" title="9.自定义task"></a>9.自定义task</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">--定义任务</div><div class="line">task print&#123;</div><div class="line">    doFirst &#123;</div><div class="line">        println &quot;01&quot;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    doLast &#123;</div><div class="line">        println &quot;02&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">--下面是向已经定义的任务里添加动作(doFirst类型的话，会向顶部添加，doLast的话，会向底部添加)</div><div class="line">print.doFirst &#123;</div><div class="line">    println &quot;03&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">print.doLast &#123;</div><div class="line">    println &quot;04&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">--上面这个特性很有用，我们可以添加一些动作到build里去</div><div class="line">build.doFirst &#123;</div><div class="line">	//...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="10-gradle基于SLF4J实现了一个日志"><a href="#10-gradle基于SLF4J实现了一个日志" class="headerlink" title="10.gradle基于SLF4J实现了一个日志"></a>10.gradle基于SLF4J实现了一个日志</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">task printVersion&lt;&lt;&#123;</div><div class="line">    logger.info(&quot;Version:$version&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h5 id="11-dependsOn任务依赖"><a href="#11-dependsOn任务依赖" class="headerlink" title="11.dependsOn任务依赖"></a>11.dependsOn任务依赖</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">task first&lt;&lt;&#123;</div><div class="line">    println &quot;one&quot;</div><div class="line">&#125;</div><div class="line">task two&lt;&lt;&#123;</div><div class="line">    println &quot;two&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">task run(dependsOn:[two, first]) &#123;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">--打印结果为：</div><div class="line">	:first</div><div class="line">	one</div><div class="line">	:two</div><div class="line">	two</div><div class="line">	:run</div></pre></td></tr></table></figure>
<blockquote>
<pre><code>**注意：上面这个依赖是没有顺序的**
</code></pre></blockquote>
<hr>
<blockquote>
<pre><code>另一种添加依赖的方式：
</code></pre></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">task third &#123;</div><div class="line">    println &quot;third&quot;</div><div class="line">&#125;</div><div class="line">third.dependsOn(&quot;run&quot;)</div></pre></td></tr></table></figure>
<h5 id="12-finalizedBy指定下一个任务"><a href="#12-finalizedBy指定下一个任务" class="headerlink" title="12.finalizedBy指定下一个任务"></a>12.finalizedBy指定下一个任务</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">task first&lt;&lt;&#123;</div><div class="line">    println &quot;one&quot;</div><div class="line">&#125;</div><div class="line">task two&lt;&lt;&#123;</div><div class="line">    println &quot;two&quot;</div><div class="line">&#125;</div><div class="line">two.finalizedBy first</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">--执行two任务，打印：</div><div class="line">	:two</div><div class="line">	two</div><div class="line">	:first</div><div class="line">	one</div></pre></td></tr></table></figure>
<h5 id="13-任务配置块"><a href="#13-任务配置块" class="headerlink" title="13.任务配置块"></a>13.任务配置块</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">task run &#123;</div><div class="line">    print(&quot;hello&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p><strong>随便运行gradle build/gradle clean…都会执行run这个任务块，这就是任务配置块</strong></p>
</blockquote>
<h6 id="为何他总会执行？"><a href="#为何他总会执行？" class="headerlink" title="为何他总会执行？"></a>为何他总会执行？</h6><blockquote>
<pre><code>要从gradle的构建生命周期来解释，每个任务执行都会经历：**初始化、配置、执行**，三个阶段，
**所以配置块在第二阶段会执行**。

==配置任务快执行是有一定顺序的，当任务A依赖任务B，则A-&gt;B的。==
</code></pre></blockquote>
<h3 id="—–gradle的多项目构建——"><a href="#—–gradle的多项目构建——" class="headerlink" title="—–gradle的多项目构建——"></a>—–gradle的多项目构建——</h3><h5 id="14-在一个项目里创建几个子项目"><a href="#14-在一个项目里创建几个子项目" class="headerlink" title="14.在一个项目里创建几个子项目"></a>14.在一个项目里创建几个子项目</h5><blockquote>
<p>结构为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">rootPrject</div><div class="line">|</div><div class="line">---sub01</div><div class="line">|       |</div><div class="line">|       ----src/main/java</div><div class="line">---sub02</div><div class="line">|       |</div><div class="line">|       ----src/main/java</div><div class="line">---subWeb</div><div class="line">|       |</div><div class="line">|       ----src/main/java</div><div class="line">---build.gradle</div><div class="line">|</div><div class="line">---settings.gradle</div></pre></td></tr></table></figure></p>
<p>在settings.gradle文件里设置：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">include &apos;sub01&apos;, &apos;sub02&apos;, &apos;subWeb&apos;</div></pre></td></tr></table></figure>
<blockquote>
<p>或者</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">include &apos;sub01&apos;</div><div class="line">include &apos;sub02&apos;</div><div class="line">include &apos;subWeb&apos;</div></pre></td></tr></table></figure>
<p>注意：==setings.gradle会在构建初始化阶段执行。==</p>
<blockquote>
<p>在根项目下配置gradle的逻辑：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">ext.projectIds = [group:&quot;com.robin&quot;, version:&quot;1.0-SNAPSHOT&quot;]</div><div class="line"></div><div class="line">group = projectIds.group;</div><div class="line">version = projectIds.version</div><div class="line"></div><div class="line">project(&quot;:sub01&quot;) &#123; //每个子模块也是一个项目，:是路径，我们可以申明sub/sub001下的sub001位一个子项目，此时写法是project(:sub:sub001)</div><div class="line">    group = projectIds.group;</div><div class="line">    version = projectIds.version</div><div class="line"></div><div class="line">    apply plugin: &quot;java&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">project(&quot;:sub02&quot;) &#123;</div><div class="line">    group = projectIds.group;</div><div class="line">    version = projectIds.version</div><div class="line"></div><div class="line">    apply plugin: &quot;java&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">project(&quot;:subWeb&quot;) &#123;</div><div class="line">    group = projectIds.group;</div><div class="line">    version = projectIds.version;</div><div class="line"></div><div class="line">    apply plugin: &quot;war&quot;</div><div class="line">    apply plugin: &quot;jetty&quot;</div><div class="line"></div><div class="line">    repositories &#123;</div><div class="line">        mavenCentral();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        providedCompile &quot;javax.servlet:servlet-api:2.5&quot;</div><div class="line">        runtime &quot;javax.servlet:jstl:1.1.2&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p> 每个项目都有group和versin属性，上面的做法是将group和version的值放入list集合然后添加到ext域里去，这样才能被其他模块引用。一般我们将其他模块需要引用的变量，我们会放入到ext里去的。</p>
</blockquote>
<h5 id="15-项目之间的依赖"><a href="#15-项目之间的依赖" class="headerlink" title="15.项目之间的依赖"></a>15.项目之间的依赖</h5><blockquote>
<p>一般子项目sub01和sub02会打成jar包的，而subWeb的子项目会打成war包的，并且subWeb项目会依赖sub01、sub02这两个项目。下面我们来生命项目之间的依赖：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">project(&quot;:sub01&quot;) &#123;</div><div class="line">    ...</div><div class="line">    apply plugin: &quot;java&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">project(&quot;:sub02&quot;) &#123;</div><div class="line"></div><div class="line">    apply plugin: &quot;java&quot;    //一定要加上这个，否则项目之间的依赖会出错</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        compile project(&apos;:sub01&apos;);   //编译时依赖sub01</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">project(&quot;:subWeb&quot;) &#123;</div><div class="line"></div><div class="line">    apply plugin: &quot;war&quot;</div><div class="line">    apply plugin: &quot;jetty&quot;</div><div class="line"></div><div class="line">    repositories &#123;</div><div class="line">        mavenCentral();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        providedCompile &quot;javax.servlet:servlet-api:2.5&quot;</div><div class="line"></div><div class="line">        compile project(&quot;:sub02&quot;)</div><div class="line">        runtime &quot;javax.servlet:jstl:1.1.2&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h6 id="使用allProjects和subProjects来构建公共项目块："><a href="#使用allProjects和subProjects来构建公共项目块：" class="headerlink" title="使用allProjects和subProjects来构建公共项目块："></a>使用allProjects和subProjects来构建公共项目块：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;       //所有的项目都共有，包括根项目和子项目</div><div class="line">    group = &quot;com.robin&quot;</div><div class="line">    version = &quot;1.0-SNAPSHOT&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">subprojects &#123;   //所有的子项目包含java插件</div><div class="line">    apply plugin: &quot;java&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>将子项目的构建脚本也写在根build.gradle写显示不是好的选择，可以在每个子项目下创建一个build.gradle文件。</p>
<ul>
<li>以后根build.gradle下只有：</li>
</ul>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;       //所有的项目都共有，包括根项目和子项目</div><div class="line">    group = &quot;com.robin&quot;</div><div class="line">    version = &quot;1.0-SNAPSHOT&quot;</div><div class="line"></div><div class="line">//    apply plugin: &quot;java&quot;  //若是这里加了java插件，那么跟项目下的src目录也是起作用，所以不建议添加在此处</div><div class="line">&#125;</div><div class="line"></div><div class="line">subprojects &#123;</div><div class="line">    apply plugin: &quot;java&quot;</div><div class="line"></div><div class="line">    sourceCompatibility = 1.8</div><div class="line"></div><div class="line">    repositories &#123;</div><div class="line">        mavenCentral()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        testCompile group: &apos;junit&apos;, name: &apos;junit&apos;, version: &apos;4.12&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>子项目subWeb的build.gradle下有：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">apply plugin: &quot;war&quot;</div><div class="line">    apply plugin: &quot;jetty&quot;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        providedCompile &quot;javax.servlet:servlet-api:2.5&quot;</div><div class="line"></div><div class="line">        compile project(&quot;:sub02&quot;)</div><div class="line">        runtime &quot;javax.servlet:jstl:1.1.2&quot;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>其他的子项目也是类似的。</p>
</blockquote>
<h3 id="—–常用插件——"><a href="#—–常用插件——" class="headerlink" title="—–常用插件——-"></a>—–常用插件——-</h3><ul>
<li>gretty插件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;org.akhikhl.gretty&apos;</div><div class="line"></div><div class="line">gretty &#123;</div><div class="line">    servletContainer = &apos;tomcat8&apos;</div><div class="line">    httpPort = 80</div><div class="line">    contextPath = &quot;&quot;</div><div class="line">    debugSuspend = false</div><div class="line">&#125;</div><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line">    dependencies &#123;</div><div class="line">        classpath &apos;org.akhikhl.gretty:gretty:+&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="———-gradle打包常用任务——–"><a href="#———-gradle打包常用任务——–" class="headerlink" title="———-gradle打包常用任务——–"></a>———-gradle打包常用任务——–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">def replace(fileName, map) &#123;</div><div class="line">    def fl = file(fileName)</div><div class="line">    def content = fl.getText(&quot;UTF-8&quot;)</div><div class="line">    map.each &#123; k, v -&gt; content = content.replace(k, v) &#125;</div><div class="line">    fl.write(content, &quot;UTF-8&quot;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">def cp(source, dest) &#123;</div><div class="line">    file(dest).write(file(source).getText(&quot;UTF-8&quot;), &quot;UTF-8&quot;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="————gradle插件开发————–"><a href="#————gradle插件开发————–" class="headerlink" title="————gradle插件开发————–"></a>————gradle插件开发————–</h3><ul>
<li>开发工具：idea, gradle<h4 id="新建工程："><a href="#新建工程：" class="headerlink" title="新建工程："></a>新建工程：</h4></li>
<li>在idea里新建root工程plugins， 修改build.gradle<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">allprojects &#123;</div><div class="line"></div><div class="line">    group &apos;com.robin&apos;</div><div class="line">    version &apos;1.0-SNAPSHOT&apos;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">subprojects &#123;</div><div class="line">    apply plugin: &apos;groovy&apos;</div><div class="line"></div><div class="line">    repositories &#123;</div><div class="line">        maven &#123;</div><div class="line">            url &quot;http://nexus.nxin.com/nexus/content/groups/public/&quot;</div><div class="line">        &#125;</div><div class="line">        mavenCentral()</div><div class="line">        jcenter()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        testCompile group: &apos;junit&apos;, name: &apos;junit&apos;, version: &apos;4.12&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="新建子工程"><a href="#新建子工程" class="headerlink" title="新建子工程"></a>新建子工程</h4><ul>
<li>新建gradle groovy的plugin01子工程，其build.gradle为：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">//插件坐标</div><div class="line">group &apos;com.nxin&apos;</div><div class="line">version &apos;1.2&apos;</div><div class="line"></div><div class="line">apply plugin: &apos;maven&apos;</div><div class="line"></div><div class="line">uploadArchives &#123;</div><div class="line">    repositories &#123;</div><div class="line">        mavenDeployer &#123;</div><div class="line">            //测试，打包到本地</div><div class="line">            repository(url: uri(&apos;../repo&apos;))</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">    compile gradleApi()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>在src/main/groovy下新建com.robin.demo.HelloPlugin.groovy类：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">package com.robin.demo</div><div class="line"></div><div class="line">import org.gradle.api.Plugin</div><div class="line">import org.gradle.api.Project</div><div class="line"></div><div class="line">/**</div><div class="line"> * Created by robin on 2017/1/12.</div><div class="line"> */</div><div class="line">class HelloPlugin implements Plugin&lt;Project&gt; &#123;</div><div class="line"></div><div class="line">    @Override</div><div class="line">    void apply(Project project) &#123;</div><div class="line"></div><div class="line">        project.task(&apos;hello&apos;) &#123;</div><div class="line">            println &quot;HelloWorld&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>给插件指定简短别名，方便 apply plugin: shortName r;在resources下新建META-INF/gradle-plugins/hello.properties,hello就是shortNmae,hello.properties里的内容为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">implementation-class=com.robin.demo.HelloPlugin</div></pre></td></tr></table></figure></p>
<p>然后在子工程下打包，执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle -q upload    //打包成jar</div></pre></td></tr></table></figure></p>
<ul>
<li>新建测试子模块 testHelloPlugin,build.gradle为：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">group &apos;com.robin&apos;</div><div class="line">version &apos;1.0-SNAPSHOT&apos;</div><div class="line"></div><div class="line">buildscript &#123;</div><div class="line">    repositories &#123;</div><div class="line">        maven &#123;</div><div class="line">            url uri(&apos;../repo&apos;)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    dependencies &#123;</div><div class="line">        classpath &apos;com.nxin:plugin01:1.2&apos;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">apply plugin: &apos;hello&apos;</div><div class="line"></div><div class="line">repositories &#123;</div><div class="line">    mavenCentral()</div><div class="line">&#125;</div><div class="line"></div><div class="line">dependencies &#123;</div><div class="line">//    compile &apos;org.codehaus.groovy:groovy-all:2.3.11&apos;</div><div class="line">//    testCompile group: &apos;junit&apos;, name: &apos;junit&apos;, version: &apos;4.11&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>在子模块中运行 gradle hello</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/gradle/" rel="tag"># gradle</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/14/测试/" rel="next" title="测试">
                <i class="fa fa-chevron-left"></i> 测试
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="robinyang" />
          <p class="site-author-name" itemprop="name">robinyang</p>
           
              <p class="site-description motion-element" itemprop="description">一入编程深似海，从此妹子是路人</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/robin0909" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#—–Java部分——"><span class="nav-number">1.</span> <span class="nav-text">—–Java部分——</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-使用java插件"><span class="nav-number">1.0.1.</span> <span class="nav-text">1.使用java插件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-定制项目"><span class="nav-number">1.0.2.</span> <span class="nav-text">2.定制项目</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#方式一："><span class="nav-number">1.0.2.1.</span> <span class="nav-text">方式一：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#方式二："><span class="nav-number">1.0.2.2.</span> <span class="nav-text">方式二：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-定义仓库"><span class="nav-number">1.0.3.</span> <span class="nav-text">3.定义仓库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-定义依赖"><span class="nav-number">1.0.4.</span> <span class="nav-text">4.定义依赖</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#——web——"><span class="nav-number">2.</span> <span class="nav-text">——web——</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-war插件的使用"><span class="nav-number">2.0.1.</span> <span class="nav-text">5.war插件的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#结构："><span class="nav-number">2.0.1.1.</span> <span class="nav-text">结构：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-定制web项目"><span class="nav-number">2.0.2.</span> <span class="nav-text">6.定制web项目</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）"><span class="nav-number">2.0.3.</span> <span class="nav-text">7.jetty插件的使用（在使用容器时，我们可以在开发阶段使用jetty当作web容器）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#—–gradle的接口——"><span class="nav-number">3.</span> <span class="nav-text">—–gradle的接口——</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#8-我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可"><span class="nav-number">3.0.1.</span> <span class="nav-text">8.我们在使用Project和Task类时，这里已经为我们提供了默认的对象，我们只需要调用方法即可</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#9-自定义task"><span class="nav-number">3.0.2.</span> <span class="nav-text">9.自定义task</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-gradle基于SLF4J实现了一个日志"><span class="nav-number">3.0.3.</span> <span class="nav-text">10.gradle基于SLF4J实现了一个日志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#11-dependsOn任务依赖"><span class="nav-number">3.0.4.</span> <span class="nav-text">11.dependsOn任务依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#12-finalizedBy指定下一个任务"><span class="nav-number">3.0.5.</span> <span class="nav-text">12.finalizedBy指定下一个任务</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#13-任务配置块"><span class="nav-number">3.0.6.</span> <span class="nav-text">13.任务配置块</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#为何他总会执行？"><span class="nav-number">3.0.6.1.</span> <span class="nav-text">为何他总会执行？</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#—–gradle的多项目构建——"><span class="nav-number">4.</span> <span class="nav-text">—–gradle的多项目构建——</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#14-在一个项目里创建几个子项目"><span class="nav-number">4.0.1.</span> <span class="nav-text">14.在一个项目里创建几个子项目</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#15-项目之间的依赖"><span class="nav-number">4.0.2.</span> <span class="nav-text">15.项目之间的依赖</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#使用allProjects和subProjects来构建公共项目块："><span class="nav-number">4.0.2.1.</span> <span class="nav-text">使用allProjects和subProjects来构建公共项目块：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#—–常用插件——"><span class="nav-number">5.</span> <span class="nav-text">—–常用插件——-</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#———-gradle打包常用任务——–"><span class="nav-number">6.</span> <span class="nav-text">———-gradle打包常用任务——–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#————gradle插件开发————–"><span class="nav-number">7.</span> <span class="nav-text">————gradle插件开发————–</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#新建工程："><span class="nav-number">7.1.</span> <span class="nav-text">新建工程：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#新建子工程"><span class="nav-number">7.2.</span> <span class="nav-text">新建子工程</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">robinyang</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


  

</body>
</html>
